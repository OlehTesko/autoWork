(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const L of document.querySelectorAll('link[rel="modulepreload"]'))A(L);new MutationObserver(L=>{for(const a of L)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&A(i)}).observe(document,{childList:!0,subtree:!0});function S(L){const a={};return L.integrity&&(a.integrity=L.integrity),L.referrerPolicy&&(a.referrerPolicy=L.referrerPolicy),L.crossOrigin==="use-credentials"?a.credentials="include":L.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function A(L){if(L.ep)return;L.ep=!0;const a=S(L);fetch(L.href,a)}})();let slideUp=(e,v=500,S=0)=>{e.classList.contains("--slide")||(e.classList.add("--slide"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=v+"ms",e.style.height=`${e.offsetHeight}px`,e.offsetHeight,e.style.overflow="hidden",e.style.height=S?`${S}px`:"0px",e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout(()=>{e.hidden=!S,S||e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),S||e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("--slide"),document.dispatchEvent(new CustomEvent("slideUpDone",{detail:{target:e}}))},v))},slideDown=(e,v=500,S=0)=>{if(!e.classList.contains("--slide")){e.classList.add("--slide"),e.hidden=e.hidden?!1:null,S&&e.style.removeProperty("height");let A=e.offsetHeight;e.style.overflow="hidden",e.style.height=S?`${S}px`:"0px",e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=v+"ms",e.style.height=A+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("--slide"),document.dispatchEvent(new CustomEvent("slideDownDone",{detail:{target:e}}))},v)}},slideToggle=(e,v=500)=>e.hidden?slideDown(e,v):slideUp(e,v);function dataMediaQueries(e,v){const S=Array.from(e).filter(a=>a.dataset[v]).map(a=>{const[i,c="max"]=a.dataset[v].split(",");return{value:i,type:c,item:a}});if(S.length===0)return[];const A=S.map(({value:a,type:i})=>`(${i}-width: ${a}px),${a},${i}`);return[...new Set(A)].map(a=>{const[i,c,r]=a.split(","),y=window.matchMedia(i);return{itemsArray:S.filter(t=>t.value===c&&t.type===r),matchMedia:y}})}function spollers(){const e=document.querySelectorAll("[data-fls-spollers]");if(e.length>0){let a=function(t,u=!1){t.forEach(p=>{p=u?p.item:p,u.matches||!u?(p.classList.add("--spoller-init"),i(p)):(p.classList.remove("--spoller-init"),i(p,!1))})},i=function(t,u=!0){let p=t.querySelectorAll("details");p.length&&p.forEach(s=>{let n=s.querySelector("summary");u?(n.removeAttribute("tabindex"),s.hasAttribute("data-fls-spollers-open")?(n.classList.add("--spoller-active"),s.open=!0):(s.open=!1,n.nextElementSibling.hidden=!0)):(n.setAttribute("tabindex","-1"),n.classList.remove("--spoller-active"),s.open=!0,n.nextElementSibling.hidden=!1)})},c=function(t){const u=t.target;if(u.closest("summary")&&u.closest("[data-fls-spollers]")&&(t.preventDefault(),u.closest("[data-fls-spollers]").classList.contains("--spoller-init"))){const p=u.closest("summary"),s=p.closest("details"),n=p.closest("[data-fls-spollers]"),o=n.hasAttribute("data-fls-spollers-one"),l=s.hasAttribute("data-fls-spollers-scroll"),f=n.dataset.flsSpollersSpeed?parseInt(n.dataset.flsSpollersSpeed):500;if(!n.querySelectorAll(".--slide").length&&(o&&!s.open&&r(n),s.open?setTimeout(()=>{s.open=!1},f):s.open=!0,p.classList.toggle("--spoller-active"),slideToggle(p.nextElementSibling,f),l&&p.classList.contains("--spoller-active"))){const m=s.dataset.flsSpollersScroll,E=+m?+m:0,h=s.hasAttribute("data-fls-spollers-scroll-noheader")?document.querySelector(".header").offsetHeight:0;window.scrollTo({top:s.offsetTop-(E+h),behavior:"smooth"})}}if(!u.closest("[data-fls-spollers]")){const p=document.querySelectorAll("[data-fls-spollers-close]");p.length&&p.forEach(s=>{const n=s.closest("[data-fls-spollers]"),o=s.parentNode;if(n.classList.contains("--spoller-init")){const l=n.dataset.flsSpollersSpeed?parseInt(n.dataset.flsSpollersSpeed):500;s.classList.remove("--spoller-active"),slideUp(s.nextElementSibling,l),setTimeout(()=>{o.open=!1},l)}})}},r=function(t){const u=t.querySelector("details[open]");if(u&&!t.querySelectorAll(".--slide").length){const p=u.querySelector("summary"),s=t.dataset.flsSpollersSpeed?parseInt(t.dataset.flsSpollersSpeed):500;p.classList.remove("--spoller-active"),slideUp(p.nextElementSibling,s),setTimeout(()=>{u.open=!1},s)}};var v=a,S=i,A=c,L=r;document.addEventListener("click",c);const y=Array.from(e).filter(function(t,u,p){return!t.dataset.flsSpollers.split(",")[0]});y.length&&a(y);let d=dataMediaQueries(e,"flsSpollers");d&&d.length&&d.forEach(t=>{t.matchMedia.addEventListener("change",function(){a(t.itemsArray,t.matchMedia)}),a(t.itemsArray,t.matchMedia)})}}window.addEventListener("load",spollers),window.addEventListener("DOMContentLoaded",()=>{const e="1ROazjZqlqZq4CPEY4Gb-TnH2iiN_Q9ytyw1GNl4Z214";function v({firstName:i="",lastName:c="",full:r="",singleCell:y=!1}){let d;return y?d=r.trim().toLowerCase().split(/\s+/).filter(Boolean):d=[i.trim().toLowerCase(),c.trim().toLowerCase()].filter(Boolean),d.sort(),d.map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}const S=[{name:"Studenty",process:i=>i.map(c=>{var r,y;const d=c.c.slice(0,3),t=((r=d[1])==null?void 0:r.v)??"",u=((y=d[2])==null?void 0:y.v)??"";return[v({firstName:u,lastName:t})]})},{name:"prihlaska",process:i=>{let c="";return i.slice(1).map(r=>r.c.slice(0,4).map((d,t)=>{let u=d?.v??"";return t===0&&(u===""?u=c:c=u,u=v({full:u,singleCell:!0})),u})).filter(r=>r.some(y=>y!==null&&y!==""))}},{name:"Doc",process:i=>i.slice(1).map(c=>{var r,y,d;const t=c.c,u=((r=t[1])==null?void 0:r.v)??"",p=((y=t[0])==null?void 0:y.v)??"",n=[v({firstName:u,lastName:p})];for(let o=2;o<t.length;o++){const l=((d=t[o])==null?void 0:d.v)??"";n.push(l!=="")}return n.pop(),n})},{name:"MAIS",process:i=>{const c=["TUKE","SPU","STU","UPJS","UNIBA","UKF","UNIZA","PEVS","UNIPO","TNUNI","TUZVO","UCM","TRUNI","UMB"],r=[];i.forEach((d,t)=>{!d||!d.c||d.c.forEach((u,p)=>{var s;const n=((s=u?.v)==null?void 0:s.toString().trim())??"";if(c.includes(n)){const o=[...r].reverse().find(f=>f.startCol===p);o&&(o.finishRow=t);let l=6;n==="TUKE"&&(l=7),r.push({value:n,startRow:t,finishRow:i.length,startCol:p,finishCol:p+l})}})});const y=[];return r.forEach(d=>{const t=[];for(let n=d.startRow;n<d.finishRow;n++){const o=i[n];if(!o||!o.c)continue;const l=o.c.slice(d.startCol,d.finishCol+1).map(m=>m?.v??"");l.every(m=>m==="")||t.push(l)}const u=t[0]?t[0].map((n,o)=>t.some(l=>l[o]!=="")):[];t.map(n=>n.filter((o,l)=>u[l])).slice(2).forEach((n,o)=>{n.length>0&&(n[0]=v({full:n[0],singleCell:!0})),y.push({university:d.value,rowIndex:d.startRow+o+2,values:n})})}),y}}];function A(i){const c=`https://docs.google.com/spreadsheets/d/${e}/gviz/tq?tqx=out:json&sheet=${i.name}`;return fetch(c).then(r=>r.text()).then(r=>{const d=JSON.parse(r.substring(47).slice(0,-2)).table.rows;return i.process(d)})}async function L(){return Promise.all(S.map(c=>A(c))).then(c=>S.reduce((y,d,t)=>(y[d.name.toLocaleLowerCase()]=c[t],y),{})).catch(c=>{console.error("\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u0456:",c)})}const a=document.querySelector(".input");L().then(i=>{window.data=JSON.stringify(i);let c=-1,r=[];const y=i.mais.filter(s=>s.university==="STU");function d(s,n,o){const l=["data-unik","data-2-uniky","data-nema-mais"];s.forEach(f=>{l.push(`open-${f[0].toLowerCase()}`)}),y.forEach(f=>{l.push(`open-e-${f.values[0].toLowerCase()}`)}),r=l.filter(f=>typeof f=="string"&&f.toLowerCase().includes(n)),o.value.length===0&&(suggestionsList.innerHTML=""),r=r.slice(0,10),c=-1,t(o)}function t(s){suggestionsList.innerHTML="",!(s.value.length===0||r.length===0)&&r.forEach((n,o)=>{const l=document.createElement("li");l.classList.add("find-item"),l.textContent=n,l.classList.toggle("active",o===c),l.addEventListener("click",()=>{s.value=n,suggestionsList.innerHTML="",u(s.value,i),s.value=""}),suggestionsList.appendChild(l)})}document.addEventListener("keydown",s=>{r.length&&(s.key==="ArrowDown"?(c=(c+1)%r.length,t(a)):s.key==="ArrowUp"?(c=(c-1+r.length)%r.length,t(a)):s.key==="Enter"&&(c>=0&&r[c]&&(a.value=r[c],suggestionsList.innerHTML=""),u(a.value,i),setTimeout(()=>{a.value=""},400),s.preventDefault()))});function u(s,n){if(s==="data-unik"||s==="data-2-uniky"||s==="data-nema-mais"){const o={};n.mais.forEach(f=>{const m=f.university,E=f.values[0],h=f.values[4],w=f.values[5];m&&(o[m]||(o[m]={university:m,total:0,intrak:[],zapis:[]}),o[m].total+=1,h!=="\u041F\u043E\u0434\u0430\u0432"&&o[m].intrak.push(E),w!=="\u041F\u043E\u0434\u0430\u0432"&&o[m].zapis.push(E))});const l=Object.values(o);p(l,s)}}function p(s,n){if(n==="data-unik"){const o=document.querySelector(".info");o.innerHTML="";const l=document.createElement("h3");l.classList.add("info__title"),l.textContent="\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430",o.appendChild(l);const f=document.createElement("div");f.classList.add("info__items"),o.appendChild(f),s.forEach(m=>{const E=document.createElement("div");E.classList.add("info__card");const h=document.createElement("h5");h.classList.add("info__card-title"),h.textContent=`${m.university} : ${m.total} \u0441\u0442\u0443\u0434\u0435\u043D\u0442`,E.appendChild(h);const w=document.createElement("div");w.classList.add("spollers"),w.setAttribute("data-fls-spollers","");for(const b of["zapis","intrak"])if(m[b].length>0){const _=document.createElement("details");_.classList.add("spollers__item");const C=document.createElement("summary");C.classList.add("spollers__title"),C.textContent=`\u041D\u0435 \u043F\u043E\u0434\u0430\u043D\u0456 ${b}: ${m[b].length}`,_.appendChild(C);const g=document.createElement("div");g.classList.add("spollers__body"),m[b].forEach(T=>{const N=document.createElement("p");N.classList.add("spollers__student"),N.textContent=T,g.appendChild(N)}),_.appendChild(g),w.appendChild(_)}E.appendChild(w),f.appendChild(E)}),spollers()}if(n==="data-nema-mais"){const o=document.querySelector(".info");o.innerHTML="";const l=i.studenty.map(C=>C[0]),f={};i.mais.forEach(C=>{const g=C.values[0],T=C.university;!g||!T||(f[g]||(f[g]={name:g,universities:new Set}),f[g].universities.add(T))});const m=[];for(const[C,g]of Object.entries(f))g.universities.size>=2&&m.push({name:g.name,universities:Array.from(g.universities)});const h=["Sarana Daria","Cherniuk Vitalii","Sydorenko Anastasiia","Novikov Dmytro","Hubenko Arsenii","Dinov Ivan","Slupetskyi Dmytro"].map(C=>v({full:C,singleCell:!0})),w=Object.keys(f),b=l.filter(C=>!w.includes(C)&&!h.includes(C)),_=document.createElement("h3");_.classList.add("info__title"),_.textContent=`${b.length} c\u0442\u0443\u0434\u0435\u043D\u0442\u0438, \u044F\u043A\u0456\u0445 \u043D\u0435\u043C\u0430\u0454 \u0432 MAIS/AIS`,o.appendChild(_),b.forEach(C=>{const g=document.createElement("p");g.classList.add("info__text"),g.textContent=C,o.appendChild(g)})}if(n==="data-2-uniky"){const o=document.querySelector(".info");o.innerHTML="",i.studenty.map(E=>E[0]);const l={};i.mais.forEach(E=>{const h=E.values[0],w=E.university;!h||!w||(l[h]||(l[h]={name:h,universities:new Set}),l[h].universities.add(w))});const f=[];for(const[E,h]of Object.entries(l))h.universities.size>=2&&f.push({name:h.name,universities:Array.from(h.universities)});const m=document.createElement("h3");m.classList.add("info__title"),m.textContent=`${f.length} c\u0442\u0443\u0434\u0435\u043D\u0442\u0438, \u044F\u043A\u0456 \u043F\u043E\u0434\u0430\u043B\u0438\u0441\u044F \u0432 2+ \u0443\u043D\u0456\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442\u0438`,o.appendChild(m),f.forEach(E=>{const h=document.createElement("p");h.classList.add("info__text"),h.textContent=`${E.name}: ${E.universities.join(", ")}`,o.appendChild(h)})}}a.addEventListener("input",s=>{d(i.studenty,a.value,a)})})});
