(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const L of document.querySelectorAll('link[rel="modulepreload"]'))A(L);new MutationObserver(L=>{for(const c of L)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&A(i)}).observe(document,{childList:!0,subtree:!0});function S(L){const c={};return L.integrity&&(c.integrity=L.integrity),L.referrerPolicy&&(c.referrerPolicy=L.referrerPolicy),L.crossOrigin==="use-credentials"?c.credentials="include":L.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function A(L){if(L.ep)return;L.ep=!0;const c=S(L);fetch(L.href,c)}})();let slideUp=(e,v=500,S=0)=>{e.classList.contains("--slide")||(e.classList.add("--slide"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=v+"ms",e.style.height=`${e.offsetHeight}px`,e.offsetHeight,e.style.overflow="hidden",e.style.height=S?`${S}px`:"0px",e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout(()=>{e.hidden=!S,S||e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),S||e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("--slide"),document.dispatchEvent(new CustomEvent("slideUpDone",{detail:{target:e}}))},v))},slideDown=(e,v=500,S=0)=>{if(!e.classList.contains("--slide")){e.classList.add("--slide"),e.hidden=e.hidden?!1:null,S&&e.style.removeProperty("height");let A=e.offsetHeight;e.style.overflow="hidden",e.style.height=S?`${S}px`:"0px",e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=v+"ms",e.style.height=A+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("--slide"),document.dispatchEvent(new CustomEvent("slideDownDone",{detail:{target:e}}))},v)}},slideToggle=(e,v=500)=>e.hidden?slideDown(e,v):slideUp(e,v);function dataMediaQueries(e,v){const S=Array.from(e).filter(c=>c.dataset[v]).map(c=>{const[i,d="max"]=c.dataset[v].split(",");return{value:i,type:d,item:c}});if(S.length===0)return[];const A=S.map(({value:c,type:i})=>`(${i}-width: ${c}px),${c},${i}`);return[...new Set(A)].map(c=>{const[i,d,l]=c.split(","),m=window.matchMedia(i);return{itemsArray:S.filter(t=>t.value===d&&t.type===l),matchMedia:m}})}function spollers(){const e=document.querySelectorAll("[data-fls-spollers]");if(e.length>0){let c=function(t,r=!1){t.forEach(p=>{p=r?p.item:p,r.matches||!r?(p.classList.add("--spoller-init"),i(p)):(p.classList.remove("--spoller-init"),i(p,!1))})},i=function(t,r=!0){let p=t.querySelectorAll("details");p.length&&p.forEach(s=>{let n=s.querySelector("summary");r?(n.removeAttribute("tabindex"),s.hasAttribute("data-fls-spollers-open")?(n.classList.add("--spoller-active"),s.open=!0):(s.open=!1,n.nextElementSibling.hidden=!0)):(n.setAttribute("tabindex","-1"),n.classList.remove("--spoller-active"),s.open=!0,n.nextElementSibling.hidden=!1)})},d=function(t){const r=t.target;if(r.closest("summary")&&r.closest("[data-fls-spollers]")&&(t.preventDefault(),r.closest("[data-fls-spollers]").classList.contains("--spoller-init"))){const p=r.closest("summary"),s=p.closest("details"),n=p.closest("[data-fls-spollers]"),o=n.hasAttribute("data-fls-spollers-one"),a=s.hasAttribute("data-fls-spollers-scroll"),f=n.dataset.flsSpollersSpeed?parseInt(n.dataset.flsSpollersSpeed):500;if(!n.querySelectorAll(".--slide").length&&(o&&!s.open&&l(n),s.open?setTimeout(()=>{s.open=!1},f):s.open=!0,p.classList.toggle("--spoller-active"),slideToggle(p.nextElementSibling,f),a&&p.classList.contains("--spoller-active"))){const y=s.dataset.flsSpollersScroll,E=+y?+y:0,h=s.hasAttribute("data-fls-spollers-scroll-noheader")?document.querySelector(".header").offsetHeight:0;window.scrollTo({top:s.offsetTop-(E+h),behavior:"smooth"})}}if(!r.closest("[data-fls-spollers]")){const p=document.querySelectorAll("[data-fls-spollers-close]");p.length&&p.forEach(s=>{const n=s.closest("[data-fls-spollers]"),o=s.parentNode;if(n.classList.contains("--spoller-init")){const a=n.dataset.flsSpollersSpeed?parseInt(n.dataset.flsSpollersSpeed):500;s.classList.remove("--spoller-active"),slideUp(s.nextElementSibling,a),setTimeout(()=>{o.open=!1},a)}})}},l=function(t){const r=t.querySelector("details[open]");if(r&&!t.querySelectorAll(".--slide").length){const p=r.querySelector("summary"),s=t.dataset.flsSpollersSpeed?parseInt(t.dataset.flsSpollersSpeed):500;p.classList.remove("--spoller-active"),slideUp(p.nextElementSibling,s),setTimeout(()=>{r.open=!1},s)}};var v=c,S=i,A=d,L=l;document.addEventListener("click",d);const m=Array.from(e).filter(function(t,r,p){return!t.dataset.flsSpollers.split(",")[0]});m.length&&c(m);let u=dataMediaQueries(e,"flsSpollers");u&&u.length&&u.forEach(t=>{t.matchMedia.addEventListener("change",function(){c(t.itemsArray,t.matchMedia)}),c(t.itemsArray,t.matchMedia)})}}window.addEventListener("load",spollers),window.addEventListener("DOMContentLoaded",()=>{const e="1ROazjZqlqZq4CPEY4Gb-TnH2iiN_Q9ytyw1GNl4Z214";function v({firstName:i="",lastName:d="",full:l="",singleCell:m=!1}){let u;return m?u=l.trim().toLowerCase().split(/\s+/).filter(Boolean):u=[i.trim().toLowerCase(),d.trim().toLowerCase()].filter(Boolean),u.sort(),u.map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}const S=[{name:"Studenty",process:i=>i.map(d=>{var l,m;const u=d.c.slice(0,3),t=((l=u[1])==null?void 0:l.v)??"",r=((m=u[2])==null?void 0:m.v)??"";return[v({firstName:r,lastName:t})]})},{name:"prihlaska",process:i=>{let d="";return i.slice(1).map(l=>l.c.slice(0,4).map((u,t)=>{let r=u?.v??"";return t===0&&(r===""?r=d:d=r,r=v({full:r,singleCell:!0})),r})).filter(l=>l.some(m=>m!==null&&m!==""))}},{name:"Doc",process:i=>i.slice(1).map(d=>{var l,m,u;const t=d.c,r=((l=t[1])==null?void 0:l.v)??"",p=((m=t[0])==null?void 0:m.v)??"",n=[v({firstName:r,lastName:p})];for(let o=2;o<t.length;o++){const a=((u=t[o])==null?void 0:u.v)??"";n.push(a!=="")}return n.pop(),n})},{name:"MAIS",process:i=>{const d=["TUKE","SPU","STU","UPJS","UNIBA","UKF","UNIZA","PEVS","UNIPO","TNUNI","TUZVO","UCM","TRUNI","UMB"],l=[];i.forEach((u,t)=>{!u||!u.c||u.c.forEach((r,p)=>{const s=r?.v??"";if(d.includes(s)){const n=l.findLast(o=>o.startCol===p);n&&(n.finishRow=t),s="TUKE",l.push({value:s,startRow:t,finishRow:i.length,startCol:p,finishCol:p+7})}})});const m=[];return l.forEach(u=>{const t=[];for(let n=u.startRow;n<u.finishRow;n++){const o=i[n];if(!o||!o.c)continue;const a=o.c.slice(u.startCol,u.finishCol+1).map(y=>y?.v??"");a.every(y=>y==="")||t.push(a)}const r=t[0]?t[0].map((n,o)=>t.some(a=>a[o]!=="")):[];t.map(n=>n.filter((o,a)=>r[a])).slice(2).forEach((n,o)=>{n.length>0&&(n[0]=v({full:n[0],singleCell:!0})),m.push({university:u.value,rowIndex:u.startRow+o+2,values:n})})}),m}}];function A(i){const d=`https://docs.google.com/spreadsheets/d/${e}/gviz/tq?tqx=out:json&sheet=${i.name}`;return fetch(d).then(l=>l.text()).then(l=>{const m=JSON.parse(l.substring(47).slice(0,-2)),u=m.table.rows,t=m.table.cols;return i.process(u,t)})}async function L(){return Promise.all(S.map(d=>A(d))).then(d=>S.reduce((m,u,t)=>(m[u.name.toLocaleLowerCase()]=d[t],m),{})).catch(d=>{console.error("\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u0456:",d)})}const c=document.querySelector(".input");L().then(i=>{window.data=JSON.stringify(i);let d=-1,l=[];const m=i.mais.filter(s=>s.university==="STU");function u(s,n,o){const a=["data-unik","data-2-uniky","data-nema-mais"];s.forEach(f=>{a.push(`open-${f[0].toLowerCase()}`)}),m.forEach(f=>{a.push(`open-e-${f.values[0].toLowerCase()}`)}),l=a.filter(f=>typeof f=="string"&&f.toLowerCase().includes(n)),o.value.length===0&&(suggestionsList.innerHTML=""),l=l.slice(0,10),d=-1,t(o)}function t(s){suggestionsList.innerHTML="",!(s.value.length===0||l.length===0)&&l.forEach((n,o)=>{const a=document.createElement("li");a.classList.add("find-item"),a.textContent=n,a.classList.toggle("active",o===d),a.addEventListener("click",()=>{s.value=n,suggestionsList.innerHTML="",r(s.value,i),s.value=""}),suggestionsList.appendChild(a)})}document.addEventListener("keydown",s=>{l.length&&(s.key==="ArrowDown"?(d=(d+1)%l.length,t(c)):s.key==="ArrowUp"?(d=(d-1+l.length)%l.length,t(c)):s.key==="Enter"&&(d>=0&&l[d]&&(c.value=l[d],suggestionsList.innerHTML=""),r(c.value,i),setTimeout(()=>{c.value=""},400),s.preventDefault()))});function r(s,n){if(s==="data-unik"||s==="data-2-uniky"||s==="data-nema-mais"){const o={};n.mais.forEach(f=>{const y=f.university,E=f.values[0],h=f.values[4],w=f.values[5];y&&(o[y]||(o[y]={university:y,total:0,intrak:[],zapis:[]}),o[y].total+=1,h!=="\u041F\u043E\u0434\u0430\u0432"&&o[y].intrak.push(E),w!=="\u041F\u043E\u0434\u0430\u0432"&&o[y].zapis.push(E))});const a=Object.values(o);p(a,s)}}function p(s,n){if(n==="data-unik"){const o=document.querySelector(".info");o.innerHTML="";const a=document.createElement("h3");a.classList.add("info__title"),a.textContent="\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430",o.appendChild(a);const f=document.createElement("div");f.classList.add("info__items"),o.appendChild(f),s.forEach(y=>{const E=document.createElement("div");E.classList.add("info__card");const h=document.createElement("h5");h.classList.add("info__card-title"),h.textContent=`${y.university} : ${y.total} \u0441\u0442\u0443\u0434\u0435\u043D\u0442`,E.appendChild(h);const w=document.createElement("div");w.classList.add("spollers"),w.setAttribute("data-fls-spollers","");for(const T of["zapis","intrak"])if(y[T].length>0){const b=document.createElement("details");b.classList.add("spollers__item");const C=document.createElement("summary");C.classList.add("spollers__title"),C.textContent=`\u041D\u0435 \u043F\u043E\u0434\u0430\u043D\u0456 ${T}: ${y[T].length}`,b.appendChild(C);const g=document.createElement("div");g.classList.add("spollers__body"),y[T].forEach(_=>{const N=document.createElement("p");N.classList.add("spollers__student"),N.textContent=_,g.appendChild(N)}),b.appendChild(g),w.appendChild(b)}E.appendChild(w),f.appendChild(E)}),spollers()}if(n==="data-nema-mais"){const o=document.querySelector(".info");o.innerHTML="";const a=i.studenty.map(C=>C[0]),f={};i.mais.forEach(C=>{const g=C.values[0],_=C.university;!g||!_||(f[g]||(f[g]={name:g,universities:new Set}),f[g].universities.add(_))});const y=[];for(const[C,g]of Object.entries(f))g.universities.size>=2&&y.push({name:g.name,universities:Array.from(g.universities)});const h=["Sarana Daria","Cherniuk Vitalii","Sydorenko Anastasiia","Novikov Dmytro","Hubenko Arsenii","Dinov Ivan","Slupetskyi Dmytro"].map(C=>v({full:C,singleCell:!0})),w=Object.keys(f),T=a.filter(C=>!w.includes(C)&&!h.includes(C)),b=document.createElement("h3");b.classList.add("info__title"),b.textContent=`${T.length} c\u0442\u0443\u0434\u0435\u043D\u0442\u0438, \u044F\u043A\u0456\u0445 \u043D\u0435\u043C\u0430\u0454 \u0432 MAIS/AIS`,o.appendChild(b),T.forEach(C=>{const g=document.createElement("p");g.classList.add("info__text"),g.textContent=C,o.appendChild(g)})}if(n==="data-2-uniky"){const o=document.querySelector(".info");o.innerHTML="",i.studenty.map(E=>E[0]);const a={};i.mais.forEach(E=>{const h=E.values[0],w=E.university;!h||!w||(a[h]||(a[h]={name:h,universities:new Set}),a[h].universities.add(w))});const f=[];for(const[E,h]of Object.entries(a))h.universities.size>=2&&f.push({name:h.name,universities:Array.from(h.universities)});const y=document.createElement("h3");y.classList.add("info__title"),y.textContent=`${f.length} c\u0442\u0443\u0434\u0435\u043D\u0442\u0438, \u044F\u043A\u0456 \u043F\u043E\u0434\u0430\u043B\u0438\u0441\u044F \u0432 2+ \u0443\u043D\u0456\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442\u0438`,o.appendChild(y),f.forEach(E=>{const h=document.createElement("p");h.classList.add("info__text"),h.textContent=`${E.name}: ${E.universities.join(", ")}`,o.appendChild(h)})}}c.addEventListener("input",s=>{u(i.studenty,c.value,c)})})});
